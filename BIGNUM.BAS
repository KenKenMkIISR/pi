REM BIGNUM CLASS

FIELD PUBLIC VALUE

METHOD INIT
 DIM VALUE(252)
 VAR I
 VALUE(0)=ARGS(1)
 FOR I=1 TO 251:VALUE(I)=0:NEXT
RETURN

METHOD SETVAL
 VAR I
 VALUE(0)=ARGS(1)
 FOR I=1 TO 251:VALUE(I)=0:NEXT
RETURN

METHOD RETVAL
RETURN VALUE(ARGS(1))

METHOD AS
 VAR I,P
 P=ARGS(1):P=P.VALUE
 FOR I=0 TO 251:VALUE(I)=P(I):NEXT
RETURN

METHOD ADD
 VAR I,C,P,Q
 P=ARGS(1):P=P.VALUE:Q=ARGS(2):Q=Q.VALUE:C=0
 FOR I=251 TO 0 STEP -1
  VALUE(I)=P(I)+Q(I)+C
  IF VALUE(I)>=10000 THEN
   VALUE(I)=VALUE(I)-10000:C=1
  ELSE
   C=0
  ENDIF
 NEXT
RETURN

METHOD SUB
 VAR I,C,P
 P=ARGS(1):P=P.VALUE:Q=ARGS(2):Q=Q.VALUE:C=0
 FOR I=251 TO 0 STEP -1
  VALUE(I)=P(I)-Q(I)-C
  IF VALUE(I)<0 THEN
   VALUE(I)=VALUE(I)+10000:C=1
  ELSE
   C=0
  ENDIF
 NEXT
RETURN

METHOD DIV
 VAR I,P,D,Q,R
 P=ARGS(1):P=P.VALUE:D=ARGS(2)
 FOR I=0 TO 251:VALUE(I)=P(I):NEXT
 FOR I=0 TO 251
  IF VALUE(I) THEN
   Q=VALUE(I)/D:R=VALUE(I)%D
   VALUE(I)=Q:VALUE(I+1)=VALUE(I+1)+R*10000
  ENDIF
 NEXT
RETURN

METHOD MUL
 VAR I,P,D,C
 P=ARGS(1):P=P.VALUE:D=ARGS(2):C=0
 FOR I=251 TO 1 STEP -1
  VALUE(I)=P(I)*D+C
  IF VALUE(I)>=10000 THEN
   C=VALUE(I)/10000
   VALUE(I)=VALUE(I)%10000
  ELSE
   C=0
  ENDIF
 NEXT
 VALUE(0)=VALUE(0)*D+C
RETURN
